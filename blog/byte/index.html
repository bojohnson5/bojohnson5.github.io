<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Bytes of Physics | Takin&#x27; a byte</title>

  <!-- STYLESHEETS -->
  <link href="https://bojohnson5.github.io/css/main.css" rel="stylesheet">
  <link href="https://bojohnson5.github.io/css/bootstrap-icons.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://bojohnson5.github.io/syntax-dark.css" media="(prefers-color-scheme: dark)" />
  <link rel="stylesheet" type="text/css" href="https://bojohnson5.github.io/syntax-light.css" media="(prefers-color-scheme: light)" />

  <!-- FAVICON -->
  
  
  
  
  
  
  <meta name="fediverse:creator" content="@awinterstein@mastodon.social">
</head>

<body class="dark:bg-gray-700 flex flex-col h-screen justify-between">
  <!---------------------------------------------------------->
  <!------------------------- NAVBAR ------------------------->
  <!---------------------------------------------------------->
  <nav id="navbar" class="bg-gray-200 dark:bg-gray-800">
    <div class="max-w-7xl mx-auto px-2 sm:px-6 lg:px-8">
      <div class="relative flex items-center justify-between h-16">
        <div class="flex items-center sm:hidden">
          <!-- Mobile menu button-->
          <button id="toggle-mobile-menu" type="button"
            class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"
            aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <i class="bi bi-list ml-1" style="font-size: 1.5rem;"></i>
          </button>
        </div>
        <div class="flex-1 flex items-center">
          <div class="flex-shrink-0 flex items-center ml-2">
            <a href="https://bojohnson5.github.io" class="text-xl text-gray-800 dark:text-white">Bytes of Physics</a>
          </div>
          <div class="hidden sm:block sm:ml-6">
            <div class="nav-links flex space-x-4">
              
 
<a href="https://bojohnson5.github.io//projects" 
    class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium"
    >Projects</a>

              
 
<a href="https://bojohnson5.github.io//skills" 
    class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium"
    >Skills</a>

              
              
              
              
              
 
<a href="https://bojohnson5.github.io//blog"  class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium"  >Blog</a>

              
              
              
              

              
            </div>
          </div>

          

          

          
        </div>
      </div>
    </div>

    <!----------------------------- Mobile menu ----------------------------->
    <div id="mobile-menu" class="sm:hidden fixed z-10 overflow-hidden">
      <div
        class="nav-links flex flex-col space-y-4 items-center w-screen bg-gray-200 dark:bg-gray-800 transition-all ease-out duration-500 h-0">
        
 
<a href="https://bojohnson5.github.io//projects" 
    class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium"
    >Projects</a>

        
 
<a href="https://bojohnson5.github.io//skills" 
    class="text-gray-800 dark:text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium"
    >Skills</a>

        
        
        
        
        
 
<a href="https://bojohnson5.github.io//blog"  class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium"  >Blog</a>

        
        
        
        

        
      </div>
    </div>
  </nav>
  <!----------------------------------------------------------->
  <!------------------------- CONTENT ------------------------->
  <!----------------------------------------------------------->
  <main class="max-w-7xl mx-auto text-black dark:text-gray-200 w-full mb-auto">
    
<div class="flex gap-x-8 mt-8 p-4 justify-center">
    <div
        class="flex flex-col md:w-3/4 w-full border border-2 border-gray-200 dark:border-black rounded-xl p-5 shadow-2xl bg-gray-200 dark:bg-gray-800">
        <div class="flex flex-col py-2 justify-center">
            <h1><a href='https:&#x2F;&#x2F;bojohnson5.github.io&#x2F;blog&#x2F;byte&#x2F;'>Takin&#x27; a byte</a></h1>
        </div>

        <!-- Metadata (date and authors) -->
        <div class="grid-flow-row space-x-6 text-gray-900 dark:text-gray-400 pl-1 mb-2">
            <!-- Blog entry date -->
            <span class="items-center whitespace-nowrap">
                <i class="bi bi-calendar-event-fill mr-1" style="font-size: 1rem;"></i>
                <span class="ml-1"><time datetime="2024-02-28">28-Feb-2024</time></span>
            </span>
            
            <!-- Blog entry word count -->
            <span class="items-center whitespace-nowrap">
                <i class="bi bi-pencil-fill mr-1" style="font-size: 1rem;"></i>
                <span class="ml-1">815 words</span>
            </span>
            <!-- Blog entry read time -->
            <span class="items-center whitespace-nowrap">
                <i class="bi bi-clock-fill mr-1" style="font-size: 1rem;"></i>
                <span class="ml-1">5 minutes</span>
            </span>
            <!-- Blog entry tags -->
            
            <span class="items-center whitespace-nowrap">
                

<a class="text-gray-900 dark:text-gray-400 py-1 items-center"
    href="https://bojohnson5.github.io/blog-tags/test/">
    <i class="bi bi-tag-fill" style="font-size: 1rem;"></i>
    <span class="pl-1">Test</span>
</a>

<a class="text-gray-900 dark:text-gray-400 py-1 items-center"
    href="https://bojohnson5.github.io/blog-tags/personal/">
    <i class="bi bi-tag-fill" style="font-size: 1rem;"></i>
    <span class="pl-1">Personal</span>
</a>


            </span>
            
        </div>



        <div id="page-content" class="text-bold">
            <p>My first summer as a graduate student I characterized a PMT for use in our upcoming ton-scale
liquid argon neutrino detector. I'd never had hardware experience coming in from undergrad so
I had to quickly learn not only about PMTs but also digitizers and the software used to control
them and later analyze data. I've since become familiar with a couple of DAQ
packages such as <a href="https://github.com/zach-hartwig/ADAQ">ADAQ</a> and <a href="https://www.caen.it/products/caen-wavedump/">WaveDump</a>.
The first package has built-in capabilities to save data to a ROOT file (ROOT being the
aforementioned data analysis software) whereas the second
one required another tool to do so. For that I used <a href="https://github.com/jintonic/toward">TOWARD</a>
developed by a collaborator at South Dakota that converts WaveDump binaries to ROOT.
Now, using ROOT takes some getting used to and it's a great tool for physics experiments and
physics analyses. However, I find the C++ baggage to slow down analysis and data exploration
to the point where I wanted to look elsewhere for a better-suited tool.</p>
<p>At first I looked into PyROOT which are Python bindings to use ROOT libraries but inside
the ease of Python programming. That means using Jupyter Notebooks is an option for plotting
data and results and quickly developing some new analysis techniques or tweaking old ones. I
like the ability to read any ROOT file like I would in a ROOT macro from Python, but once
again, there are built-in limitations when you use Python. For example, I was attempting to
work with results from a GEANT4 simulation with PyROOT which required looping over
200,000 generated events. The code I had was running for over an hour-and-a-half before I
gave up on it. The same ROOT macro, on the other hand, took 10-20 seconds to run. So I felt
the need to look elsewhere for the ability to analyze data from a ROOT file that wasn't a
ROOT script or required PyROOT. And that led me back to Julia.</p>
<p>I'd used Julia for a summer in undergrad for fun. I spent some time reading the documentation
and different tutorials but never had a real project to put my mind towards solving with
Julia. And I figured in grad school everyone used Python and ROOT (read C++) so I should
stick with and master those. But now that I'd exhausted those options for what I was trying
to do, I thought I could resurrect what I'd learned about Julia from a few years prior. One
of the first things I wanted to do was revisit my PMT analysis code and rewrite some of it
in Julia. A simple ROOT script from the TOWARD code was converting WaveDump binary files to
ROOT. Here are a few lines from that code:</p>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++">ifstream <span class="z-keyword z-operator z-c++">*</span>input <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-keyword z-control z-c++">new</span> <span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">ifstream</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-meta z-function-call z-c++"><span class="z-variable z-function z-c++">Form</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span><span class="z-constant z-other z-placeholder z-c">%s</span>/<span class="z-constant z-other z-placeholder z-c">%s</span><span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span><span class="z-punctuation z-separator z-c++">,</span>run<span class="z-punctuation z-separator z-c++">,</span>file</span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-separator z-c++">,</span> ios<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>binary</span></span><span class="z-meta z-function-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span><span class="z-source z-c++">input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">seekg</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-separator z-c++">,</span> ios<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>end</span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> move getter to the end of file
</span></span><span class="z-source z-c++"><span class="z-storage z-type z-c">long</span> <span class="z-storage z-type z-c">int</span> fsize <span class="z-keyword z-operator z-assignment z-c">=</span> input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">tellg</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span><span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> get input file size
</span></span><span class="z-source z-c++">input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">seekg</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-separator z-c++">,</span> ios<span class="z-punctuation z-accessor z-double-colon z-c++">::</span>beg</span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> move getter back to the beginning
</span></span><span class="z-source z-c++"><span class="z-storage z-type z-c">short</span> adc<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">99999</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-block z-end z-c++">}</span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-storage z-type z-c">float</span> s<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">99999</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-block z-end z-c++">}</span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> waveform samples
</span></span><span class="z-source z-c++"><span class="z-storage z-type z-c">int</span> n<span class="z-punctuation z-separator z-c++">,</span> len<span class="z-punctuation z-separator z-c++">,</span> tmp<span class="z-punctuation z-separator z-c++">,</span> cha<span class="z-punctuation z-separator z-c++">,</span> evt<span class="z-punctuation z-separator z-c++">,</span> ttt<span class="z-punctuation z-separator z-c++">,</span> tt<span class="z-punctuation z-separator z-c++">,</span> th<span class="z-punctuation z-separator z-c++">,</span> tl<span class="z-punctuation z-terminator z-c++">;</span>
</span></code></pre>
<p>This reads in the binary file and gets the file size in bytes along with creating variables
to be stored in a ROOT file. After creating ROOT branches for the new file, the code
reads the event header from the binary file. The binary file has a structure of six
four-byte integers followed by a series of ADC values stored from the digitizer. The number
of two-byte ADC integers is found in the header with a little algebra. The header and ADC
values are read in as:</p>
<pre data-lang="cpp" class="language-cpp z-code"><code class="language-cpp" data-lang="cpp"><span class="z-source z-c++"><span class="z-keyword z-control z-c++">while</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">good</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span> <span class="z-keyword z-operator z-arithmetic z-c">&amp;&amp;</span> input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">tellg</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-keyword z-operator z-comparison z-c">&lt;</span>fsize<span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>len<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> size of data [bytes]
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>tmp<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> board id
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>tmp<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> VME specific
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>cha<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> channel id
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>evt<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> event id
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>ttt<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span><span class="z-constant z-numeric z-integer z-decimal z-c++">4</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> trigger time tag
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  n <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>len<span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">24</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-keyword z-operator z-arithmetic z-c">/</span>ssize<span class="z-punctuation z-terminator z-c++">;</span> <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> number of waveform samples
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++">  <span class="z-keyword z-control z-c++">for</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">int</span> i<span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-comparison z-c">&lt;</span>n<span class="z-punctuation z-terminator z-c++">;</span> i<span class="z-keyword z-operator z-arithmetic z-c">++</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">    input<span class="z-punctuation z-accessor z-arrow z-c++">-&gt;</span><span class="z-meta z-method-call z-c++"><span class="z-variable z-function z-member z-c++">read</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-keyword z-operator z-word z-cast z-c++">reinterpret_cast</span><span class="z-punctuation z-section z-generic z-begin z-c++">&lt;</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-generic z-end z-c++">&gt;</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-keyword z-operator z-c">&amp;</span>adc<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-separator z-c++">,</span>ssize</span></span><span class="z-meta z-method-call z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-punctuation z-terminator z-c++">;</span> s<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-keyword z-operator z-assignment z-c">=</span><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">float</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>adc<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>i<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">  <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span><span class="z-source z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></code></pre>
<p>With the code above being the core of the what converts the binary file, I set about doing
the same in Julia. I started with nearly a line-for-line rewrite, using something like:</p>
<pre data-lang="julia" class="language-julia z-code"><code class="language-julia" data-lang="julia"><span class="z-source z-julia">open<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">&quot;</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">file<span class="z-punctuation z-definition z-string z-end z-julia">&quot;</span></span></span>, <span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia"><span class="z-punctuation z-definition z-string z-begin z-julia">&quot;</span></span></span><span class="z-meta z-string z-julia"><span class="z-string z-quoted z-double z-julia">w<span class="z-punctuation z-definition z-string z-end z-julia">&quot;</span></span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span> <span class="z-keyword z-control z-julia">do</span> io
</span><span class="z-source z-julia">  seekend<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">  fsize <span class="z-keyword z-operator z-assignment z-julia">=</span> position<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">  seekstart<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">  len <span class="z-keyword z-operator z-assignment z-julia">=</span> Vector{UInt<span class="z-constant z-numeric z-julia">8</span>}<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-language z-julia">undef</span>, <span class="z-constant z-numeric z-julia">4</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">  read<span class="z-keyword z-operator z-julia">!</span><span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io, len<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">  len <span class="z-keyword z-operator z-assignment z-julia">=</span> reinterpret<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>reshape, Int<span class="z-constant z-numeric z-julia">32</span>, len<span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia"><span class="z-keyword z-other z-julia">end</span>
</span></code></pre>
<p>Similar code would need to be written for the other variables and ADC values. But as you
can imagine, this was pretty long and unwieldy, reading in each byte into a vector bytes of
the correct length and then reinterpreting it as the correct-sized integer. After reading
different posts on the Julia <a href="https://discourse.julialang.org">Discourse</a> and elsewhere
I quickly found much simpler solutions than my naive rewrite above. It turns out you can
directly read in the correct-sized integers with a simple <code>read(io, Int32)</code>, or better
yet, read in the whole header and ADC values as</p>
<pre data-lang="julia" class="language-julia z-code"><code class="language-julia" data-lang="julia"><span class="z-source z-julia">header <span class="z-keyword z-operator z-assignment z-julia">=</span> read<span class="z-keyword z-operator z-julia">!</span><span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io, Vector{Int<span class="z-constant z-numeric z-julia">32</span>}<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-language z-julia">undef</span>, <span class="z-constant z-numeric z-julia">6</span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span><span class="z-source z-julia">adcs <span class="z-keyword z-operator z-assignment z-julia">=</span> read<span class="z-keyword z-operator z-julia">!</span><span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span>io, Vector{Int<span class="z-constant z-numeric z-julia">16</span>}<span class="z-meta z-group z-julia"><span class="z-punctuation z-section z-group z-begin z-julia">(</span><span class="z-constant z-language z-julia">undef</span>, adc_length<span class="z-punctuation z-section z-group z-end z-julia">)</span></span><span class="z-punctuation z-section z-group z-end z-julia">)</span></span>
</span></code></pre>
<p>where the <code>adc_length</code> is determined as in the TOWARD code. This greatly simplified
my first attempt at reading a binary file. And to take it one step further, I wanted
to remove any ROOT dependency at all and found <a href="https://github.com/JuliaIO/JLD2.jl">JLD2.jl</a>
which is a pure Julia file format. Adding in some code to save to a <code>.jld2</code> file and
compressing it with <a href="https://github.com/JuliaIO/CodecZlib.jl">CodecZlib.jl</a> I could
beat the compressed ROOT file by almost a factor of two.</p>
<p>So if you find yourself needing to read a binary file from scratch, I'd recommend using
Julia, as the ease and simplicity make for a great experience. And you can get back to
your physics analysis sooner.</p>

        </div>

        
        
    </div>
</div>

  </main>

  <!----------------------------------------------------------->
  <!------------------------- PAGINATION ---------------------->
  <!------------------------- --------------------------------->
  
  
  

  <!---------------------------------------------------------->
  <!------------------------- FOOTER ------------------------->
  <!---------------------------------------------------------->
  <footer class="max-w-7xl mx-auto relative pt-1 px-2 border-b-2 border-gray-300 dark:border-gray-200 w-full">
    <div class="mt-16 border-t-2 border-gray-300 flex flex-col items-center">
      <div class="sm:w-2/3 text-center">
        <p class="text-sm text-black dark:text-white font-bold py-6">
          
          © 2025 <a href="https://github.com/awinterstein/zola-theme-project-portfolio/">Project Portfolio</a> theme made with <a
          href="https://tailwindcss.com/" target="_blank">Tailwind CSS</a> for <a href="https://www.getzola.org/"
            target="_blank">Zola</a>
          
        </p>
      </div>
    </div>
  </footer>

  <!------------------------- SCRIPTS ------------------------->
  <script defer src="https://bojohnson5.github.io/js/main.js"></script>
  
  
  
</body>

</html>